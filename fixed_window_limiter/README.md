# 固定窗口限流算法

## 算法介绍

固定窗口限流算法是一种常用的限流算法。它通过控制在一个固定时间窗口内允许通过的请求数量来控制请求速率。如果在当前时间窗口内已经达到了限制数量，则新的请求将被拒绝。

## 结构

在Go中，我们可以使用结构体来实现固定窗口限流器。下面是一个简单的例子：

```go
type FixedWindowLimiter struct {
	mu       sync.Mutex    //锁
	limit    int           //限流阈值
	interval time.Duration //时间窗口长度
	count    int           //当前时间窗口内已经通过的请求数量
	lastTime time.Time     //上一次请求通过时所处的时间窗口的起始时间
}
```
## 方法及参数
我们定义了一个NewFixedWindowRateLimiter函数来创建一个新的固定窗口限流器。该函数接受两个参数：limit和interval，分别表示限制数量和时间窗口长度。

此外，我们还需要定义一个Allow()方法来判断是否允许通过请求。该方法不需要任何参数。

## 实现思路
在创建新的固定窗口限流器时，我们需要初始化结构体中的各个字段。然后，在调用Allow()方法时，我们首先检查当前时间是否超过了上一次请求通过时所处时间窗口的结束时间。如果超过，则重置计数器并更新上一次请求通过时所处时间窗口的起始时间。

接下来，判断计数器是否小于限制数量。如果小于，则增加计数器并返回true；否则返回false。

## 测试实现思路
在这个测试用例中，我们首先创建了一个新的 `FixedWindowLimiter` 实例，限流阈值为 2，时间窗口长度为 1 秒。然后，我们调用 `Allow` 方法来测试限流器的行为。
前两次调用 `Allow` 方法应该返回 `true`，因为此时时间窗口内已经通过的请求数量还没有达到限流阈值。
第三次调用 `Allow` 方法应该返回 `false`，因为此时时间窗口内已经通过的请求数量已经达到了限流阈值。
接下来，我们等待一个时间窗口长度的时间，让当前时间窗口过期。然后再次调用 `Allow` 方法，此时应该返回 `true`